
import warnings
from utils import *

warnings.simplefilter(action='ignore', category=FutureWarning)
curr = os.getcwd()
dir_path = os.getcwd() + '/dataT'
patterns = ["/STATPOP????.csv", "/STATENT????_*[0-9].csv", "/GWS????_HA.csv"]
datasets = ['statpop', 'gws', 'statent']
DB_FILE_PATH = dir_path + '/test.db' 

print("Start extracting files in directory...")
for pattern in patterns:
    dir_name = pattern.lower().split("?")[0].split("/")[1]
    print("Extracting directory ", dir_name)
    way = dir_path + '/%s' %dir_name
    extracting(way, pattern)
print("Extraction from zip files is done.")
print("Processing csv files...")
for dataset in datasets:
    print("CURRENT DATASET:", dataset)
    preparing_csv(dir_path, dataset)
print("CSV files processed successfully. \nStarting creating database...")

creation3 = """ CREATE TABLE IF NOT EXISTS statent
(E_KOORD real,
N_KOORD real,
X_KOORD real,
Y_KOORD real,
RELI integer,
B08T integer,
B08S1 integer,
B08S2 integer,
B08S3 integer,
B08EMPT integer,
B08EMPTS1 integer,
B08EMPFS1 integer,
B08EMPMS1 integer,
B08EMPTS2 integer,
B08EMPFS2 integer,
B08EMPMS2 integer,
B08EMPTS3 integer,
B08EMPFS3 integer,
B08EMPMS3 integer,
B08VZAT real,
B08VZATS1 real,
B08VZAFS1 real,
B08VZAMS1 real,
B08VZATS2 real,
B08VZAFS2 real,
B08VZAMS2 real,
B08VZATS3 real,
B08VZAFS3 real,
B08VZAMS3 real,
B0801AS integer,
B0802AS integer,
B0803AS integer,
B0805AS integer,
B0806AS integer,
B0807AS integer,
B0808AS integer,
B0809AS integer,
B0810AS integer,
B0811AS integer,
B0812AS integer,
B0813AS integer,
B0814AS integer,
B0815AS integer,
B0816AS integer,
B0817AS integer,
B0818AS integer,
B0819AS integer,
B0820AS integer,
B0821AS integer,
B0822AS integer,
B0823AS integer,
B0824AS integer,
B0825AS integer,
B0826AS integer,
B0827AS integer,
B0828AS integer,
B0829AS integer,
B0830AS integer,
B0831AS integer,
B0832AS integer,
B0833AS integer,
B0835AS integer,
B0836AS integer,
B0837AS integer,
B0838AS integer,
B0839AS integer,
B0841AS integer,
B0842AS integer,
B0843AS integer,
B0845AS integer,
B0846AS integer,
B0847AS integer,
B0849AS integer,
B0850AS integer,
B0851AS integer,
B0852AS integer,
B0853AS integer,
B0855AS integer,
B0856AS integer,
B0858AS integer,
B0859AS integer,
B0860AS integer,
B0861AS integer,
B0862AS integer,
B0863AS integer,
B0864AS integer,
B0865AS integer,
B0866AS integer,
B0868AS integer,
B0869AS integer,
B0870AS integer,
B0871AS integer,
B0872AS integer,
B0873AS integer,
B0874AS integer,
B0875AS integer,
B0877AS integer,
B0878AS integer,
B0879AS integer,
B0880AS integer,
B0881AS integer,
B0882AS integer,
B0884AS integer,
B0885AS integer,
B0886AS integer,
B0887AS integer,
B0888AS integer,
B0890AS integer,
B0891AS integer,
B0892AS integer,
B0893AS integer,
B0894AS integer,
B0895AS integer,
B0896AS integer,
B0801EMP integer,
B0802EMP integer,
B0803EMP integer,
B0805EMP integer,
B0806EMP integer,
B0807EMP integer,
B0808EMP integer,
B0809EMP integer,
B0810EMP integer,
B0811EMP integer,
B0812EMP integer,
B0813EMP integer,
B0814EMP integer,
B0815EMP integer,
B0816EMP integer,
B0817EMP integer,
B0818EMP integer,
B0819EMP integer,
B0820EMP integer,
B0821EMP integer,
B0822EMP integer,
B0823EMP integer,
B0824EMP integer,
B0825EMP integer,
B0826EMP integer,
B0827EMP integer,
B0828EMP integer,
B0829EMP integer,
B0830EMP integer,
B0831EMP integer,
B0832EMP integer,
B0833EMP integer,
B0835EMP integer,
B0836EMP integer,
B0837EMP integer,
B0838EMP integer,
B0839EMP integer,
B0841EMP integer,
B0842EMP integer,
B0843EMP integer,
B0845EMP integer,
B0846EMP integer,
B0847EMP integer,
B0849EMP integer,
B0850EMP integer,
B0851EMP integer,
B0852EMP integer,
B0853EMP integer,
B0855EMP integer,
B0856EMP integer,
B0858EMP integer,
B0859EMP integer,
B0860EMP integer,
B0861EMP integer,
B0862EMP integer,
B0863EMP integer,
B0864EMP integer,
B0865EMP integer,
B0866EMP integer,
B0868EMP integer,
B0869EMP integer,
B0870EMP integer,
B0871EMP integer,
B0872EMP integer,
B0873EMP integer,
B0874EMP integer,
B0875EMP integer,
B0877EMP integer,
B0878EMP integer,
B0879EMP integer,
B0880EMP integer,
B0881EMP integer,
B0882EMP integer,
B0884EMP integer,
B0885EMP integer,
B0886EMP integer,
B0887EMP integer,
B0888EMP integer,
B0890EMP integer,
B0891EMP integer,
B0892EMP integer,
B0893EMP integer,
B0894EMP integer,
B0895EMP integer,
B0896EMP integer,
B0801VZA real,
B0802VZA real,
B0803VZA real,
B0805VZA integer,
B0806VZA integer,
B0807VZA integer,
B0808VZA real,
B0809VZA real,
B0810VZA real,
B0811VZA real,
B0812VZA real,
B0813VZA real,
B0814VZA real,
B0815VZA real,
B0816VZA real,
B0817VZA real,
B0818VZA real,
B0819VZA real,
B0820VZA real,
B0821VZA real,
B0822VZA real,
B0823VZA real,
B0824VZA real,
B0825VZA real,
B0826VZA real,
B0827VZA real,
B0828VZA real,
B0829VZA real,
B0830VZA real,
B0831VZA real,
B0832VZA real,
B0833VZA real,
B0835VZA real,
B0836VZA real,
B0837VZA real,
B0838VZA real,
B0839VZA real,
B0841VZA real,
B0842VZA real,
B0843VZA real,
B0845VZA real,
B0846VZA real,
B0847VZA real,
B0849VZA real,
B0850VZA real,
B0851VZA real,
B0852VZA real,
B0853VZA real,
B0855VZA real,
B0856VZA real,
B0858VZA real,
B0859VZA real,
B0860VZA real,
B0861VZA real,
B0862VZA real,
B0863VZA real,
B0864VZA real,
B0865VZA real,
B0866VZA real,
B0868VZA real,
B0869VZA real,
B0870VZA real,
B0871VZA real,
B0872VZA real,
B0873VZA real,
B0874VZA real,
B0875VZA real,
B0877VZA real,
B0878VZA real,
B0879VZA real,
B0880VZA real,
B0881VZA real,
B0882VZA real,
B0884VZA real,
B0885VZA real,
B0886VZA real,
B0887VZA real,
B0888VZA real,
B0890VZA real,
B0891VZA real,
B0892VZA real,
B0893VZA real,
B0894VZA real,
B0895VZA real,
B0896VZA real,
B0801KB1 integer,
B0801KB2 integer,
B0801KB3 integer,
B0801KB4 integer,
B0802KB1 integer,
B0802KB2 integer,
B0802KB3 integer,
B0802KB4 integer,
B0803KB1 integer,
B0803KB2 integer,
B0803KB3 integer,
B0803KB4 integer,
B0805KB1 integer,
B0805KB2 integer,
B0805KB3 integer,
B0805KB4 integer,
B0806KB1 integer,
B0806KB2 integer,
B0806KB3 integer,
B0806KB4 integer,
B0807KB1 integer,
B0807KB2 integer,
B0807KB3 integer,
B0807KB4 integer,
B0808KB1 integer,
B0808KB2 integer,
B0808KB3 integer,
B0808KB4 integer,
B0809KB1 integer,
B0809KB2 integer,
B0809KB3 integer,
B0809KB4 integer,
B0810KB1 integer,
B0810KB2 integer,
B0810KB3 integer,
B0810KB4 integer,
B0811KB1 integer,
B0811KB2 integer,
B0811KB3 integer,
B0811KB4 integer,
B0812KB1 integer,
B0812KB2 integer,
B0812KB3 integer,
B0812KB4 integer,
B0813KB1 integer,
B0813KB2 integer,
B0813KB3 integer,
B0813KB4 integer,
B0814KB1 integer,
B0814KB2 integer,
B0814KB3 integer,
B0814KB4 integer,
B0815KB1 integer,
B0815KB2 integer,
B0815KB3 integer,
B0815KB4 integer,
B0816KB1 integer,
B0816KB2 integer,
B0816KB3 integer,
B0816KB4 integer,
B0817KB1 integer,
B0817KB2 integer,
B0817KB3 integer,
B0817KB4 integer,
B0818KB1 integer,
B0818KB2 integer,
B0818KB3 integer,
B0818KB4 integer,
B0819KB1 integer,
B0819KB2 integer,
B0819KB3 integer,
B0819KB4 integer,
B0820KB1 integer,
B0820KB2 integer,
B0820KB3 integer,
B0820KB4 integer,
B0821KB1 integer,
B0821KB2 integer,
B0821KB3 integer,
B0821KB4 integer,
B0822KB1 integer,
B0822KB2 integer,
B0822KB3 integer,
B0822KB4 integer,
B0823KB1 integer,
B0823KB2 integer,
B0823KB3 integer,
B0823KB4 integer,
B0824KB1 integer,
B0824KB2 integer,
B0824KB3 integer,
B0824KB4 integer,
B0825KB1 integer,
B0825KB2 integer,
B0825KB3 integer,
B0825KB4 integer,
B0826KB1 integer,
B0826KB2 integer,
B0826KB3 integer,
B0826KB4 integer,
B0827KB1 integer,
B0827KB2 integer,
B0827KB3 integer,
B0827KB4 integer,
B0828KB1 integer,
B0828KB2 integer,
B0828KB3 integer,
B0828KB4 integer,
B0829KB1 integer,
B0829KB2 integer,
B0829KB3 integer,
B0829KB4 integer,
B0830KB1 integer,
B0830KB2 integer,
B0830KB3 integer,
B0830KB4 integer,
B0831KB1 integer,
B0831KB2 integer,
B0831KB3 integer,
B0831KB4 integer,
B0832KB1 integer,
B0832KB2 integer,
B0832KB3 integer,
B0832KB4 integer,
B0833KB1 integer,
B0833KB2 integer,
B0833KB3 integer,
B0833KB4 integer,
B0835KB1 integer,
B0835KB2 integer,
B0835KB3 integer,
B0835KB4 integer,
B0836KB1 integer,
B0836KB2 integer,
B0836KB3 integer,
B0836KB4 integer,
B0837KB1 integer,
B0837KB2 integer,
B0837KB3 integer,
B0837KB4 integer,
B0838KB1 integer,
B0838KB2 integer,
B0838KB3 integer,
B0838KB4 integer,
B0839KB1 integer,
B0839KB2 integer,
B0839KB3 integer,
B0839KB4 integer,
B0841KB1 integer,
B0841KB2 integer,
B0841KB3 integer,
B0841KB4 integer,
B0842KB1 integer,
B0842KB2 integer,
B0842KB3 integer,
B0842KB4 integer,
B0843KB1 integer,
B0843KB2 integer,
B0843KB3 integer,
B0843KB4 integer,
B0845KB1 integer,
B0845KB2 integer,
B0845KB3 integer,
B0845KB4 integer,
B0846KB1 integer,
B0846KB2 integer,
B0846KB3 integer,
B0846KB4 integer,
B0847KB1 integer,
B0847KB2 integer,
B0847KB3 integer,
B0847KB4 integer,
B0849KB1 integer,
B0849KB2 integer,
B0849KB3 integer,
B0849KB4 integer,
B0850KB1 integer,
B0850KB2 integer,
B0850KB3 integer,
B0850KB4 integer,
B0851KB1 integer,
B0851KB2 integer,
B0851KB3 integer,
B0851KB4 integer,
B0852KB1 integer,
B0852KB2 integer,
B0852KB3 integer,
B0852KB4 integer,
B0853KB1 integer,
B0853KB2 integer,
B0853KB3 integer,
B0853KB4 integer,
B0855KB1 integer,
B0855KB2 integer,
B0855KB3 integer,
B0855KB4 integer,
B0856KB1 integer,
B0856KB2 integer,
B0856KB3 integer,
B0856KB4 integer,
B0858KB1 integer,
B0858KB2 integer,
B0858KB3 integer,
B0858KB4 integer,
B0859KB1 integer,
B0859KB2 integer,
B0859KB3 integer,
B0859KB4 integer,
B0860KB1 integer,
B0860KB2 integer,
B0860KB3 integer,
B0860KB4 integer,
B0861KB1 integer,
B0861KB2 integer,
B0861KB3 integer,
B0861KB4 integer,
B0862KB1 integer,
B0862KB2 integer,
B0862KB3 integer,
B0862KB4 integer,
B0863KB1 integer,
B0863KB2 integer,
B0863KB3 integer,
B0863KB4 integer,
B0864KB1 integer,
B0864KB2 integer,
B0864KB3 integer,
B0864KB4 integer,
B0865KB1 integer,
B0865KB2 integer,
B0865KB3 integer,
B0865KB4 integer,
B0866KB1 integer,
B0866KB2 integer,
B0866KB3 integer,
B0866KB4 integer,
B0868KB1 integer,
B0868KB2 integer,
B0868KB3 integer,
B0868KB4 integer,
B0869KB1 integer,
B0869KB2 integer,
B0869KB3 integer,
B0869KB4 integer,
B0870KB1 integer,
B0870KB2 integer,
B0870KB3 integer,
B0870KB4 integer,
B0871KB1 integer,
B0871KB2 integer,
B0871KB3 integer,
B0871KB4 integer,
B0872KB1 integer,
B0872KB2 integer,
B0872KB3 integer,
B0872KB4 integer,
B0873KB1 integer,
B0873KB2 integer,
B0873KB3 integer,
B0873KB4 integer,
B0874KB1 integer,
B0874KB2 integer,
B0874KB3 integer,
B0874KB4 integer,
B0875KB1 integer,
B0875KB2 integer,
B0875KB3 integer,
B0875KB4 integer,
B0877KB1 integer,
B0877KB2 integer,
B0877KB3 integer,
B0877KB4 integer,
B0878KB1 integer,
B0878KB2 integer,
B0878KB3 integer,
B0878KB4 integer,
B0879KB1 integer,
B0879KB2 integer,
B0879KB3 integer,
B0879KB4 integer,
B0880KB1 integer,
B0880KB2 integer,
B0880KB3 integer,
B0880KB4 integer,
B0881KB1 integer,
B0881KB2 integer,
B0881KB3 integer,
B0881KB4 integer,
B0882KB1 integer,
B0882KB2 integer,
B0882KB3 integer,
B0882KB4 integer,
B0884KB1 integer,
B0884KB2 integer,
B0884KB3 integer,
B0884KB4 integer,
B0885KB1 integer,
B0885KB2 integer,
B0885KB3 integer,
B0885KB4 integer,
B0886KB1 integer,
B0886KB2 integer,
B0886KB3 integer,
B0886KB4 integer,
B0887KB1 integer,
B0887KB2 integer,
B0887KB3 integer,
B0887KB4 integer,
B0888KB1 integer,
B0888KB2 integer,
B0888KB3 integer,
B0888KB4 integer,
B0890KB1 integer,
B0890KB2 integer,
B0890KB3 integer,
B0890KB4 integer,
B0891KB1 integer,
B0891KB2 integer,
B0891KB3 integer,
B0891KB4 integer,
B0892KB1 integer,
B0892KB2 integer,
B0892KB3 integer,
B0892KB4 integer,
B0893KB1 integer,
B0893KB2 integer,
B0893KB3 integer,
B0893KB4 integer,
B0894KB1 integer,
B0894KB2 integer,
B0894KB3 integer,
B0894KB4 integer,
B0895KB1 integer,
B0895KB2 integer,
B0895KB3 integer,
B0895KB4 integer,
B0896KB1 integer,
B0896KB2 integer,
B0896KB3 integer,
B0896KB4 integer,
year integer)
"""

creation1 = """ CREATE TABLE IF NOT EXISTS statpop
                    (
RELI integer,
X_KOORD real,
Y_KOORD real,
E_KOORD real,
N_KOORD real,
BTOT integer,
B11 integer,
B12 integer,
B13 integer,
B14 integer,
B15 integer,
B16 integer,
B21 integer,
B22 integer,
B23 integer,
B24 integer,
B25 integer,
B26 integer,
B27 integer,
B28 integer,
B29 integer,
B30 integer,
BMTOT integer,
BM01 integer,
BM02 integer,
BM03 integer,
BM04 integer,
BM05 integer,
BM06 integer,
BM07 integer,
BM08 integer,
BM09 integer,
BM10 integer,
BM11 integer,
BM12 integer,
BM13 integer,
BM14 integer,
BM15 integer,
BM16 integer,
BM17 integer,
BM18 integer,
BM19 integer,
BWTOT integer,
BW01 integer,
BW02 integer,
BW03 integer,
BW04 integer,
BW05 integer,
BW06 integer,
BW07 integer,
BW08 integer,
BW09 integer,
BW10 integer,
BW11 integer,
BW12 integer,
BW13 integer,
BW14 integer,
BW15 integer,
BW16 integer,
BW17 integer,
BW18 integer,
BW19 integer,
B41 integer,
B42 integer,
B43 integer,
B44 integer,
B45 integer,
B46 integer,
B51 integer,
B52 integer,
B53 integer,
B54 integer,
B55 integer,
B56 integer,
PTOT integer,
P01 integer,
P02 integer,
P03 integer,
P04 integer,
P05 integer,
P06 integer,
PI integer,
year integer
)"""

creation2 = """ CREATE TABLE IF NOT EXISTS gws
                    (
X_KOORD integer,
Y_KOORD integer,
E_KOORD integer,
N_KOORD integer,
RELI integer,
GTOT integer,
GA01 integer,
GA02 integer,
GA03 integer,
GA05 integer,
GA06 integer,
GA07 integer,
GA08 integer,
GB01 integer,
GB02 integer,
GB03 integer,
GB04 integer,
GB05 integer,
GB06 integer,
GB07 integer,
GB08 integer,
GB09 integer,
GB10 integer,
GB11 integer,
GB12 real,
GG01 integer,
GG02 integer,
GG03 integer,
GG04 integer,
GG05 integer,
GG06 integer,
GG07 integer,
GG08 integer,
GG09 integer,
GH01 integer,
GH02 integer,
GH03 integer,
GH04 integer,
GH05 integer,
GH17 integer,
GH19 integer,
GE01 integer,
GE02 integer,
GE03 integer,
GE04 integer,
GE05 integer,
GE06 integer,
GE07 integer,
GE08 integer,
GE17 integer,
GE19 integer,
GEWW01 integer,
GEWW02 integer,
GEWW03 integer,
GEWW04 integer,
GEWW05 integer,
GEWW06 integer,
GEWW07 integer,
GEWW08 integer,
GEWW17 integer,
GEWW19 integer,
GW00 integer,
GW01 integer,
GW02 integer,
GW03 integer,
GW04 integer,
GW05 integer,
GW06 integer,
GW07 integer,
GW10 integer,
WTOT integer,
WTF integer,
WT01 integer,
WT02 integer,
WT03 integer,
WT04 integer,
WT05 integer,
WT06 integer,
WT07 integer,
WT08 integer,
WT09 integer,
WT10 integer,
WT11 integer,
WT12 real,
WT1 integer,
WT1F integer,
WT101 integer,
WT102 integer,
WT103 integer,
WT104 integer,
WT105 integer,
WT106 integer,
WT107 integer,
WT108 integer,
WT109 integer,
WT110 integer,
WT111 integer,
WT112 real,
WT2 integer,
WT2F integer,
WT201 integer,
WT202 integer,
WT203 integer,
WT204 integer,
WT205 integer,
WT206 integer,
WT207 integer,
WT208 integer,
WT209 integer,
WT210 integer,
WT211 integer,
WT212 real,
WT3 integer,
WT3F integer,
WT301 integer,
WT302 integer,
WT303 integer,
WT304 integer,
WT305 integer,
WT306 integer,
WT307 integer,
WT308 integer,
WT309 integer,
WT310 integer,
WT311 integer,
WT312 real,
WT4 integer,
WT4F integer,
WT401 integer,
WT402 integer,
WT403 integer,
WT404 integer,
WT405 integer,
WT406 integer,
WT407 integer,
WT408 integer,
WT409 integer,
WT410 integer,
WT411 integer,
WT412 real,
WT5 integer,
WT5F integer,
WT501 integer,
WT502 integer,
WT503 integer,
WT504 integer,
WT505 integer,
WT506 integer,
WT507 integer,
WT508 integer,
WT509 integer,
WT510 integer,
WT511 integer,
WT512 real,
WT6 integer,
WT6F integer,
WT601 integer,
WT602 integer,
WT603 integer,
WT604 integer,
WT605 integer,
WT606 integer,
WT607 integer,
WT608 integer,
WT609 integer,
WT610 integer,
WT611 integer,
WT612 real,
year integer)"""

d = {'statpop':creation1, 'gws':creation2, 'statent':creation3}
if __name__ == '__main__':

    for dataset in datasets:
        os.chdir(dir_path + '/' + dataset)
        print("Current working directory:", os.getcwd())
        for item in os.listdir(dir_path + '/' + dataset):
            if item.endswith('.csv'):
                print("Current CSV:", item)
                file_name = os.path.abspath(item)
                print("DATASET, FILE_NAME:" ,dataset, file_name)
                insert_values_to_table(dataset, file_name, d.get(dataset), DB_FILE_PATH)
    #init_spatialite(DB_FILE_PATH)
    print("Spatial database was created successfully.")

d2 = {'gstatpop':creation1, 'ggws':creation2, 'gstatent':creation3}
# initialize geometry extension (I had done it)
# load geometry extension
# create new tables
# create geometry column
# insert values